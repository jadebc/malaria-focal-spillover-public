
R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ################################################
> # Spillover effects of reactive, focal malaria 
> # interventions
> 
> # Namibia trial
> # Primary analysis: incidence
> 
> # Sensitivity analysis
> # Exclude cohorts with target areas
> # that overlap with spillover zones or
> # spillover zones that overlap with spillover zones
> 
> 
> # Setting Q level to cohort to match 
> # level selected for primary analysis 
> ################################################ 
> rm(list=ls())
> library(sl3)
> library(tmle3)
> library(origami)
origami v1.0.5: Generalized Framework for Cross-Validation
> library(SuperLearner)
Loading required package: nnls
Loading required package: gam
Loading required package: splines
Loading required package: foreach
Loaded gam 1.20

Super Learner
Version: 2.0-28
Package created on 2021-05-04

> library(glmnet)
Loading required package: Matrix
Loaded glmnet 4.1-2
> library(gam)
> library(xgboost)
> library(GGally)
Loading required package: ggplot2
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
> 
> source(paste0(here::here(), "/0-config.R"))
Loading required package: sp
Please note that rgdal will be retired by the end of 2023,
plan transition to sf/stars/terra functions using GDAL and PROJ
at your earliest convenience.

rgdal: version: 1.5-28, (SVN revision 1158)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 3.4.1, released 2021/12/27
Path to GDAL shared files: /share/software/user/open/gdal/3.4.1/share/gdal
GDAL binary built with GEOS: FALSE 
Loaded PROJ runtime: Rel. 8.2.1, January 1st, 2022, [PJ_VERSION: 821]
Path to PROJ shared files: /home/users/jadebc/.local/share/proj:/share/software/user/open/proj/8.2.1/share/proj:/share/software/user/open/proj/8.2.1/share/proj
PROJ CDN enabled: FALSE
Linking to sp version:1.4-5
To mute warnings of possible GDAL/OSR exportToProj4() degradation,
use options("rgdal_show_exportToProj4_warnings"="none") before loading sp or rgdal.

Attaching package: ‘tidyr’

The following objects are masked from ‘package:Matrix’:

    expand, pack, unpack


Attaching package: ‘lubridate’

The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union


Attaching package: ‘reshape2’

The following object is masked from ‘package:tidyr’:

    smiths


Attaching package: ‘purrr’

The following objects are masked from ‘package:foreach’:

    accumulate, when


Attaching package: ‘data.table’

The following object is masked from ‘package:purrr’:

    transpose

The following objects are masked from ‘package:reshape2’:

    dcast, melt

The following objects are masked from ‘package:lubridate’:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year


Attaching package: ‘dplyr’

The following objects are masked from ‘package:data.table’:

    between, first, last

The following object is masked from ‘package:xgboost’:

    slice

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> 
> # load data ---------------------------------------
> data_human_list <- readRDS(namibia_human_process_sens_nooverlap_spill_path)
> data_mosq_list <- readRDS(namibia_mosq_process_sens_nooverlap_spill_path)
> data_hm_list <- readRDS(namibia_hm_process_sens_nooverlap_spill_path)
> 
> # load covariate list ---------------------------------------
> covarname <- readRDS(namibia_inc_covar_sens_nooverlap_spill_path)
> covarname_g = c("pre_spray_cover", "pre_incidence", "pre_rainfall",
+                 "pop_size_ea","pre_evi", "ea_elevation","surface_temp")
> covarname_Q = covarname[!covarname %in% c(covarname_g)]
> 
> # SuperLearner set up ---------------------------------------
> source(paste0(here::here(), '/2-analysis/0-namibia-incidence-learners.R'))
> 
> 
> # Run hTMLE - Total effect ---------------------------------------
> 
> ## Human ---------------------------------------
> tic()
> set.seed(123)
> res_total_human <- 
+   run_hTMLE(df = data_human_list$short,
+             effecttype = 'total',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g,
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Human")
[1] "Fitting htmle model ======================================="
[1] "Covariate screening ---------------------------------"
Loading required package: lmtest
Loading required package: zoo

Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric


Likelihood Ratio Test P-values:
                P-value
pre_spray_cover       0
pre_incidence         0
pre_rainfall          0
pop_size_ea           0
pre_evi               0
ea_elevation          0
surface_temp          0


Covariates selected (P<0.2):
                      P-value
pre_spray_cover  5.507360e-10
pre_incidence   2.469799e-246
pre_rainfall    1.068579e-108
pop_size_ea      5.053120e-14
pre_evi          1.908494e-45
ea_elevation     1.155825e-87
surface_temp    3.132538e-128
[1] "===== variables excluded after lmtest ===== "
character(0)
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pop_size_ea"    
[5] "pre_evi"         "ea_elevation"    "surface_temp"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.04214
pop_500m                 0.00001
pop_1km                  0.00230
pop_2km                  0.00000
pop_3km                  0.73955
sex                      0.00497
dist_hh                  0.00664
dist_hf                  0.01316
pop_size_cohort          0.04124
Ntx                      0.00000
tx_cov_cohort            0.72956
high_season              0.00000
prop_prev_tx             0.00000
pre_int_3000             0.00000
pre_int_2000             0.00554
pre_int_1000             0.00000
pre_int_500              0.00038
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.00714
pre_int_propdiffarm_1000 0.00000
pre_int_propdiffarm_2000 0.02682
pre_int_propdiffarm_3000 0.00000
age                      0.03137
delta_age                0.00000
response_time            0.00000
delta_response_time      0.73764
delta_age.1              0.00000
delta_response_time.1    0.73764
delta_dist_index_quant   0.21404


Covariates selected (P<0.2):
                              P-value
dist_to_index            4.213688e-02
pop_500m                 6.821065e-06
pop_1km                  2.296242e-03
pop_2km                  5.814673e-07
sex                      4.967271e-03
dist_hh                  6.639154e-03
dist_hf                  1.315782e-02
pop_size_cohort          4.124111e-02
Ntx                      2.854259e-09
high_season              4.964084e-16
prop_prev_tx             6.706666e-13
pre_int_3000             1.837825e-06
pre_int_2000             5.538406e-03
pre_int_1000             2.349485e-21
pre_int_500              3.820864e-04
n_int_pre_recei          7.546602e-29
pre_int_propdiffarm_500  7.140406e-03
pre_int_propdiffarm_1000 3.175373e-13
pre_int_propdiffarm_2000 2.682044e-02
pre_int_propdiffarm_3000 5.315163e-09
age                      3.137336e-02
delta_age                6.645829e-70
response_time            3.558011e-29
delta_age.1              6.645829e-70
[1] "===== variables excluded after lmtest ===== "
[1] "pop_3km"                "tx_cov_cohort"          "delta_response_time"   
[4] "delta_dist_index_quant"
[1] "===== variables excluded after sparsity check ===== "
[1] "pre_int_propdiffarm_500"
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "pop_500m"                
 [3] "pop_1km"                  "pop_2km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "dist_hf"                  "pop_size_cohort"         
 [9] "Ntx"                      "high_season"             
[11] "prop_prev_tx"             "pre_int_3000"            
[13] "pre_int_2000"             "pre_int_1000"            
[15] "pre_int_500"              "n_int_pre_recei"         
[17] "pre_int_propdiffarm_1000" "pre_int_propdiffarm_2000"
[19] "pre_int_propdiffarm_3000" "age"                     
[21] "delta_age"                "response_time"           
7.326 sec elapsed
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "Cohort-level covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.74853
pre_incidence   0.00006
pre_rainfall    0.00459
pop_size_ea     0.58415
pre_evi         0.01518
ea_elevation    0.81209
surface_temp    0.72457


Covariates selected (P<0.2):
                   P-value
pre_incidence 5.984758e-05
pre_rainfall  4.587612e-03
pre_evi       1.517798e-02
[1] "===== variables excluded after lmtest ===== "
[1] "pre_spray_cover" "pop_size_ea"     "ea_elevation"    "surface_temp"   
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_incidence" "pre_rainfall"  "pre_evi"      

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.57740
pop_500m                 0.09336
pop_1km                  0.75915
pop_2km                  0.09819
pop_3km                  0.91787
sex                      0.84897
dist_hh                  0.64692
dist_hf                  0.14192
pop_size_cohort          0.10576
Ntx                      0.09488
tx_cov_cohort            0.37731
high_season              0.00402
prop_prev_tx             0.02124
pre_int_3000             0.02428
pre_int_2000             0.03356
pre_int_1000             0.00390
pre_int_500              0.08391
n_int_pre_recei          0.00021
pre_int_propdiffarm_500  0.26072
pre_int_propdiffarm_1000 0.01977
pre_int_propdiffarm_2000 0.42863
pre_int_propdiffarm_3000 0.20139
age                      0.01100
delta_age                0.01667
response_time            0.00024
delta_response_time      0.33319
delta_dist_index_quant   0.03682


Covariates selected (P<0.2):
                              P-value
pop_500m                 0.0933606509
pop_2km                  0.0981862937
dist_hf                  0.1419158885
pop_size_cohort          0.1057623550
Ntx                      0.0948798307
high_season              0.0040177405
prop_prev_tx             0.0212352437
pre_int_3000             0.0242773240
pre_int_2000             0.0335631085
pre_int_1000             0.0038972403
pre_int_500              0.0839130119
n_int_pre_recei          0.0002114330
pre_int_propdiffarm_1000 0.0197696219
age                      0.0110018108
delta_age                0.0166701305
response_time            0.0002351408
delta_dist_index_quant   0.0368209080
[1] "===== variables excluded after lmtest ===== "
 [1] "dist_to_index"            "pop_1km"                 
 [3] "pop_3km"                  "sex"                     
 [5] "dist_hh"                  "tx_cov_cohort"           
 [7] "pre_int_propdiffarm_500"  "pre_int_propdiffarm_2000"
 [9] "pre_int_propdiffarm_3000" "delta_response_time"     
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "pop_500m"                 "pop_2km"                 
 [3] "dist_hf"                  "pop_size_cohort"         
 [5] "Ntx"                      "high_season"             
 [7] "prop_prev_tx"             "pre_int_3000"            
 [9] "pre_int_2000"             "pre_int_1000"            
[11] "pre_int_500"              "n_int_pre_recei"         
[13] "pre_int_propdiffarm_1000" "age"                     
[15] "delta_age"                "response_time"           
[17] "delta_dist_index_quant"  
[1] "<20 obs per covariate for g model; creating small regression learners"
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.01, 0.006"
[1] "updated Qbar1W, Qbar0W: 0.008, 0.01"
11.637 sec elapsed
> toc()
25.154 sec elapsed
> 
> saveRDS(res_total_human, file = paste0(results_path, "namibia_htmle_inc_total_human_sens_nooverlap_spill.RDS"))
> 
> ## Mosquito ---------------------------------------
> set.seed(123)
> res_total_mosq <- 
+   run_hTMLE(df = data_mosq_list$long,
+             effecttype = 'total',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g,
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Mosquito")
[1] "Fitting htmle model ======================================="
[1] "Covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover       0
pre_incidence         0
pre_rainfall          0
pop_size_ea           0
pre_evi               0
ea_elevation          0
surface_temp          0


Covariates selected (P<0.2):
                      P-value
pre_spray_cover  8.142389e-63
pre_incidence   1.613194e-289
pre_rainfall     3.531182e-33
pop_size_ea     4.418877e-105
pre_evi          9.372051e-35
ea_elevation    2.205510e-301
surface_temp     8.122810e-67
[1] "===== variables excluded after lmtest ===== "
character(0)
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pop_size_ea"    
[5] "pre_evi"         "ea_elevation"    "surface_temp"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.00019
pop_500m                 0.00000
pop_1km                  0.00000
pop_2km                  0.00098
pop_3km                  0.07580
sex                      0.00000
dist_hh                  0.00103
dist_hf                  0.00000
pop_size_cohort          0.23534
Ntx                      0.00000
tx_cov_cohort            0.00622
high_season              0.00009
prop_prev_tx             0.00000
pre_int_3000             0.00000
pre_int_2000             0.00000
pre_int_1000             0.00000
pre_int_500              0.00000
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.00004
pre_int_propdiffarm_1000 0.00000
pre_int_propdiffarm_2000 0.00003
pre_int_propdiffarm_3000 0.00000
age                      0.01331
delta_age                0.00000
response_time            0.00000
delta_response_time      0.58596
delta_age.1              0.00000
delta_response_time.1    0.58596
delta_dist_index_quant   0.18325


Covariates selected (P<0.2):
                               P-value
dist_to_index             1.940090e-04
pop_500m                  4.868359e-09
pop_1km                   2.875586e-07
pop_2km                   9.762523e-04
pop_3km                   7.579738e-02
sex                       2.451451e-08
dist_hh                   1.029520e-03
dist_hf                   8.828808e-09
Ntx                       3.158237e-21
tx_cov_cohort             6.216340e-03
high_season               9.080951e-05
prop_prev_tx              4.448048e-74
pre_int_3000              1.582562e-23
pre_int_2000              4.029177e-32
pre_int_1000              5.518943e-81
pre_int_500               3.226499e-18
n_int_pre_recei           3.703802e-69
pre_int_propdiffarm_500   4.482941e-05
pre_int_propdiffarm_1000  4.481098e-30
pre_int_propdiffarm_2000  2.538591e-05
pre_int_propdiffarm_3000  1.613932e-12
age                       1.330878e-02
delta_age                6.053473e-174
response_time             2.862474e-57
delta_age.1              6.053473e-174
delta_dist_index_quant    1.832507e-01
[1] "===== variables excluded after lmtest ===== "
[1] "pop_size_cohort"     "delta_response_time"
[1] "===== variables excluded after sparsity check ===== "
[1] "pre_int_propdiffarm_500"
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "pop_500m"                
 [3] "pop_1km"                  "pop_2km"                 
 [5] "pop_3km"                  "sex"                     
 [7] "dist_hh"                  "dist_hf"                 
 [9] "Ntx"                      "tx_cov_cohort"           
[11] "high_season"              "prop_prev_tx"            
[13] "pre_int_3000"             "pre_int_2000"            
[15] "pre_int_1000"             "pre_int_500"             
[17] "n_int_pre_recei"          "pre_int_propdiffarm_1000"
[19] "pre_int_propdiffarm_2000" "pre_int_propdiffarm_3000"
[21] "age"                      "delta_age"               
[23] "response_time"            "delta_dist_index_quant"  
9.69 sec elapsed
[1] "Choose Qlevel ---------------------------------"
0.001 sec elapsed
[1] "Cohort-level covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.02029
pre_incidence   0.02103
pre_rainfall    0.25906
pop_size_ea     0.61201
pre_evi         0.24238
ea_elevation    0.02744
surface_temp    0.88772


Covariates selected (P<0.2):
                   P-value
pre_spray_cover 0.02029447
pre_incidence   0.02102554
ea_elevation    0.02744243
[1] "===== variables excluded after lmtest ===== "
[1] "pre_rainfall" "pop_size_ea"  "pre_evi"      "surface_temp"
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "ea_elevation"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.52539
pop_500m                 0.07969
pop_1km                  0.96504
pop_2km                  0.25014
pop_3km                  0.71589
sex                      0.75232
dist_hh                  0.59031
dist_hf                  0.01571
pop_size_cohort          0.15425
Ntx                      0.00971
tx_cov_cohort            0.64352
high_season              0.30905
prop_prev_tx             0.00000
pre_int_3000             0.00012
pre_int_2000             0.00000
pre_int_1000             0.00000
pre_int_500              0.00059
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.13635
pre_int_propdiffarm_1000 0.00190
pre_int_propdiffarm_2000 0.23966
pre_int_propdiffarm_3000 0.18331
age                      0.00206
delta_age                0.00016
response_time            0.00002
delta_response_time      0.47352
delta_dist_index_quant   0.27945


Covariates selected (P<0.2):
                              P-value
pop_500m                 7.969054e-02
dist_hf                  1.571373e-02
pop_size_cohort          1.542461e-01
Ntx                      9.709358e-03
prop_prev_tx             2.069648e-06
pre_int_3000             1.247207e-04
pre_int_2000             4.854173e-06
pre_int_1000             2.904116e-07
pre_int_500              5.893084e-04
n_int_pre_recei          9.502418e-11
pre_int_propdiffarm_500  1.363550e-01
pre_int_propdiffarm_1000 1.900590e-03
pre_int_propdiffarm_3000 1.833139e-01
age                      2.058556e-03
delta_age                1.612388e-04
response_time            1.797365e-05
[1] "===== variables excluded after lmtest ===== "
 [1] "dist_to_index"            "pop_1km"                 
 [3] "pop_2km"                  "pop_3km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "tx_cov_cohort"            "high_season"             
 [9] "pre_int_propdiffarm_2000" "delta_response_time"     
[11] "delta_dist_index_quant"  
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "pop_500m"                 "dist_hf"                 
 [3] "pop_size_cohort"          "Ntx"                     
 [5] "prop_prev_tx"             "pre_int_3000"            
 [7] "pre_int_2000"             "pre_int_1000"            
 [9] "pre_int_500"              "n_int_pre_recei"         
[11] "pre_int_propdiffarm_500"  "pre_int_propdiffarm_1000"
[13] "pre_int_propdiffarm_3000" "age"                     
[15] "delta_age"                "response_time"           
[1] "<20 obs per covariate for g model; creating small regression learners"
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.013, 0.017"
[1] "updated Qbar1W, Qbar0W: 0.013, 0.016"
9.856 sec elapsed
> toc()
> 
> saveRDS(res_total_mosq, file = paste0(results_path, "namibia_htmle_inc_total_mosq_sens_nooverlap_spill.RDS"))
> 
> ## Human & mosquito ---------------------------------------
> set.seed(123)
> res_total_hm <- 
+   run_hTMLE(df = data_hm_list$long,
+             effecttype = 'total',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g, # setting to mean to avoid unstable estimates
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Human & mosquito",
+             Vfolds = 30)
[1] "Fitting htmle model ======================================="
[1] "Covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.00028
pre_incidence   0.00000
pre_rainfall    0.00000
pop_size_ea     0.00008
pre_evi         0.00000
ea_elevation    0.00000
surface_temp    0.00433


Covariates selected (P<0.2):
                      P-value
pre_spray_cover  2.807172e-04
pre_incidence   5.968506e-312
pre_rainfall     0.000000e+00
pop_size_ea      7.888911e-05
pre_evi          2.285640e-31
ea_elevation    8.997511e-178
surface_temp     4.325303e-03
[1] "===== variables excluded after lmtest ===== "
character(0)
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pop_size_ea"    
[5] "pre_evi"         "ea_elevation"    "surface_temp"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.00007
pop_500m                 0.00000
pop_1km                  0.00057
pop_2km                  0.58582
pop_3km                  0.18734
sex                      0.00008
dist_hh                  0.00004
dist_hf                  0.00000
pop_size_cohort          0.86962
Ntx                      0.00388
tx_cov_cohort            0.52124
high_season              0.00002
prop_prev_tx             0.00000
pre_int_3000             0.00000
pre_int_2000             0.00000
pre_int_1000             0.00000
pre_int_500              0.00000
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.02120
pre_int_propdiffarm_1000 0.00000
pre_int_propdiffarm_2000 0.00000
pre_int_propdiffarm_3000 0.00004
age                      0.00023
delta_age                0.00000
response_time            0.00000
delta_response_time      0.70632
delta_age.1              0.00000
delta_response_time.1    0.70632
delta_dist_index_quant   0.88393


Covariates selected (P<0.2):
                              P-value
dist_to_index            6.579744e-05
pop_500m                 2.436600e-07
pop_1km                  5.688364e-04
pop_3km                  1.873429e-01
sex                      8.145733e-05
dist_hh                  3.678233e-05
dist_hf                  4.909535e-19
Ntx                      3.881226e-03
high_season              2.124222e-05
prop_prev_tx             1.253516e-66
pre_int_3000             1.633983e-20
pre_int_2000             2.880490e-42
pre_int_1000             4.878349e-65
pre_int_500              5.005366e-17
n_int_pre_recei          1.141226e-40
pre_int_propdiffarm_500  2.119830e-02
pre_int_propdiffarm_1000 4.407587e-20
pre_int_propdiffarm_2000 1.254405e-08
pre_int_propdiffarm_3000 4.098174e-05
age                      2.279285e-04
delta_age                1.399931e-83
response_time            1.420170e-48
delta_age.1              1.399931e-83
[1] "===== variables excluded after lmtest ===== "
[1] "pop_2km"                "pop_size_cohort"        "tx_cov_cohort"         
[4] "delta_response_time"    "delta_dist_index_quant"
[1] "===== variables excluded after sparsity check ===== "
[1] "pre_int_propdiffarm_500"
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "pop_500m"                
 [3] "pop_1km"                  "pop_3km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "dist_hf"                  "Ntx"                     
 [9] "high_season"              "prop_prev_tx"            
[11] "pre_int_3000"             "pre_int_2000"            
[13] "pre_int_1000"             "pre_int_500"             
[15] "n_int_pre_recei"          "pre_int_propdiffarm_1000"
[17] "pre_int_propdiffarm_2000" "pre_int_propdiffarm_3000"
[19] "age"                      "delta_age"               
[21] "response_time"           
4.452 sec elapsed
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "Cohort-level covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.07235
pre_incidence   0.00016
pre_rainfall    0.01121
pop_size_ea     0.45865
pre_evi         0.16731
ea_elevation    0.32191
surface_temp    0.88105


Covariates selected (P<0.2):
                     P-value
pre_spray_cover 0.0723475739
pre_incidence   0.0001640757
pre_rainfall    0.0112088086
pre_evi         0.1673106511
[1] "===== variables excluded after lmtest ===== "
[1] "pop_size_ea"  "ea_elevation" "surface_temp"
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pre_evi"        

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.19792
pop_500m                 0.30476
pop_1km                  0.96078
pop_2km                  0.73244
pop_3km                  0.84515
sex                      1.00000
dist_hh                  0.34715
dist_hf                  0.00901
pop_size_cohort          0.52912
Ntx                      0.41046
tx_cov_cohort            0.84578
high_season              0.20119
prop_prev_tx             0.00002
pre_int_3000             0.00601
pre_int_2000             0.00004
pre_int_1000             0.00001
pre_int_500              0.00094
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.34285
pre_int_propdiffarm_1000 0.03259
pre_int_propdiffarm_2000 0.22822
pre_int_propdiffarm_3000 0.80987
age                      0.08429
delta_age                0.00718
response_time            0.00027
delta_response_time      0.47137
delta_dist_index_quant   0.89857


Covariates selected (P<0.2):
                              P-value
dist_to_index            1.979159e-01
dist_hf                  9.014189e-03
prop_prev_tx             1.512179e-05
pre_int_3000             6.010134e-03
pre_int_2000             3.732879e-05
pre_int_1000             1.256034e-05
pre_int_500              9.446101e-04
n_int_pre_recei          3.020206e-07
pre_int_propdiffarm_1000 3.258873e-02
age                      8.429231e-02
delta_age                7.183500e-03
response_time            2.721365e-04
[1] "===== variables excluded after lmtest ===== "
 [1] "pop_500m"                 "pop_1km"                 
 [3] "pop_2km"                  "pop_3km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "pop_size_cohort"          "Ntx"                     
 [9] "tx_cov_cohort"            "high_season"             
[11] "pre_int_propdiffarm_500"  "pre_int_propdiffarm_2000"
[13] "pre_int_propdiffarm_3000" "delta_response_time"     
[15] "delta_dist_index_quant"  
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
[1] "sex"
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "dist_hf"                 
 [3] "prop_prev_tx"             "pre_int_3000"            
 [5] "pre_int_2000"             "pre_int_1000"            
 [7] "pre_int_500"              "n_int_pre_recei"         
 [9] "pre_int_propdiffarm_1000" "age"                     
[11] "delta_age"                "response_time"           
[1] "<20 obs per covariate for g model; creating small regression learners"
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.013, 0.015"
[1] "updated Qbar1W, Qbar0W: 0.012, 0.018"
29.016 sec elapsed
> 
> saveRDS(res_total_hm, file = paste0(results_path, "namibia_htmle_inc_total_hm_sens_nooverlap_spill.RDS"))
> 
> 
> # Run hTMLE - Spillover effect ---------------------------------------
> 
> ## Human ---------------------------------------
> tic()
> set.seed(123)
> res_spillover_human <- 
+   run_hTMLE(df = data_human_list$short,
+             effecttype = 'spillover',
+             Qlevel = "individual", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g,
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Human")
[1] "Fitting htmle model ======================================="
[1] "Covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover       0
pre_incidence         0
pre_rainfall          0
pop_size_ea           0
pre_evi               0
ea_elevation          0
surface_temp          0


Covariates selected (P<0.2):
                      P-value
pre_spray_cover  3.040003e-11
pre_incidence   2.197018e-176
pre_rainfall     4.501759e-88
pop_size_ea      9.512316e-13
pre_evi          3.101403e-32
ea_elevation     3.171321e-90
surface_temp    1.398672e-127
[1] "===== variables excluded after lmtest ===== "
character(0)
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pop_size_ea"    
[5] "pre_evi"         "ea_elevation"    "surface_temp"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.00067
pop_500m                 0.00014
pop_1km                  0.00084
pop_2km                  0.00000
pop_3km                  0.49228
sex                      0.00011
dist_hh                  0.01053
dist_hf                  0.01226
pop_size_cohort          0.15605
Ntx                      0.00000
tx_cov_cohort            0.18137
high_season              0.00000
prop_prev_tx             0.00000
pre_int_3000             0.00000
pre_int_2000             0.00287
pre_int_1000             0.00000
pre_int_500              0.00023
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.00958
pre_int_propdiffarm_1000 0.00000
pre_int_propdiffarm_2000 0.05629
pre_int_propdiffarm_3000 0.00000
age                      0.00525
delta_age                0.00000
response_time            0.00000
delta_response_time      0.67357
delta_age.1              0.00000
delta_response_time.1    0.67357
delta_dist_index_quant   0.40701


Covariates selected (P<0.2):
                              P-value
dist_to_index            6.683770e-04
pop_500m                 1.386489e-04
pop_1km                  8.378991e-04
pop_2km                  1.753520e-07
sex                      1.118779e-04
dist_hh                  1.053456e-02
dist_hf                  1.226422e-02
pop_size_cohort          1.560484e-01
Ntx                      1.017394e-09
tx_cov_cohort            1.813676e-01
high_season              6.765503e-15
prop_prev_tx             5.153680e-14
pre_int_3000             1.283576e-07
pre_int_2000             2.871099e-03
pre_int_1000             2.400948e-23
pre_int_500              2.328252e-04
n_int_pre_recei          7.103205e-31
pre_int_propdiffarm_500  9.580977e-03
pre_int_propdiffarm_1000 2.246591e-13
pre_int_propdiffarm_2000 5.628555e-02
pre_int_propdiffarm_3000 1.218925e-09
age                      5.251650e-03
delta_age                2.353032e-78
response_time            1.073620e-29
delta_age.1              2.353032e-78
[1] "===== variables excluded after lmtest ===== "
[1] "pop_3km"                "delta_response_time"    "delta_dist_index_quant"
[1] "===== variables excluded after sparsity check ===== "
[1] "pre_int_propdiffarm_500"
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "pop_500m"                
 [3] "pop_1km"                  "pop_2km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "dist_hf"                  "pop_size_cohort"         
 [9] "Ntx"                      "tx_cov_cohort"           
[11] "high_season"              "prop_prev_tx"            
[13] "pre_int_3000"             "pre_int_2000"            
[15] "pre_int_1000"             "pre_int_500"             
[17] "n_int_pre_recei"          "pre_int_propdiffarm_1000"
[19] "pre_int_propdiffarm_2000" "pre_int_propdiffarm_3000"
[21] "age"                      "delta_age"               
[23] "response_time"           
6.361 sec elapsed
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "Cohort-level covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.74853
pre_incidence   0.00006
pre_rainfall    0.00459
pop_size_ea     0.58415
pre_evi         0.01518
ea_elevation    0.81209
surface_temp    0.72457


Covariates selected (P<0.2):
                   P-value
pre_incidence 5.984758e-05
pre_rainfall  4.587612e-03
pre_evi       1.517798e-02
[1] "===== variables excluded after lmtest ===== "
[1] "pre_spray_cover" "pop_size_ea"     "ea_elevation"    "surface_temp"   
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_incidence" "pre_rainfall"  "pre_evi"      

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.43287
pop_500m                 0.18287
pop_1km                  0.79813
pop_2km                  0.08224
pop_3km                  0.87671
sex                      1.00000
dist_hh                  0.72231
dist_hf                  0.12790
pop_size_cohort          0.17418
Ntx                      0.05412
tx_cov_cohort            0.62991
high_season              0.00559
prop_prev_tx             0.01446
pre_int_3000             0.01555
pre_int_2000             0.02729
pre_int_1000             0.00193
pre_int_500              0.06944
n_int_pre_recei          0.00047
pre_int_propdiffarm_500  0.29041
pre_int_propdiffarm_1000 0.02372
pre_int_propdiffarm_2000 0.52731
pre_int_propdiffarm_3000 0.24108
age                      0.00627
delta_age                0.02191
response_time            0.00024
delta_response_time      0.28348
delta_dist_index_quant   0.00037


Covariates selected (P<0.2):
                              P-value
pop_500m                 0.1828660172
pop_2km                  0.0822357355
dist_hf                  0.1279017928
pop_size_cohort          0.1741848585
Ntx                      0.0541178499
high_season              0.0055944601
prop_prev_tx             0.0144560095
pre_int_3000             0.0155542364
pre_int_2000             0.0272864269
pre_int_1000             0.0019288336
pre_int_500              0.0694442370
n_int_pre_recei          0.0004739021
pre_int_propdiffarm_1000 0.0237233623
age                      0.0062683172
delta_age                0.0219100221
response_time            0.0002366607
delta_dist_index_quant   0.0003680197
[1] "===== variables excluded after lmtest ===== "
 [1] "dist_to_index"            "pop_1km"                 
 [3] "pop_3km"                  "sex"                     
 [5] "dist_hh"                  "tx_cov_cohort"           
 [7] "pre_int_propdiffarm_500"  "pre_int_propdiffarm_2000"
 [9] "pre_int_propdiffarm_3000" "delta_response_time"     
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
[1] "sex"
[1] "===== variables selected in the end ===== "
 [1] "pop_500m"                 "pop_2km"                 
 [3] "dist_hf"                  "pop_size_cohort"         
 [5] "Ntx"                      "high_season"             
 [7] "prop_prev_tx"             "pre_int_3000"            
 [9] "pre_int_2000"             "pre_int_1000"            
[11] "pre_int_500"              "n_int_pre_recei"         
[13] "pre_int_propdiffarm_1000" "age"                     
[15] "delta_age"                "response_time"           
[17] "delta_dist_index_quant"  
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.008, 0.006"
[1] "updated Qbar1W, Qbar0W: 0.007, 0.007"
237.544 sec elapsed
> toc()
248.915 sec elapsed
> 
> saveRDS(res_spillover_human, file = paste0(results_path, "namibia_htmle_inc_spillover_human_sens_nooverlap_spill.RDS"))
> 
> ## Mosquito ---------------------------------------
> tic()
> set.seed(123)
> res_spillover_mosq <-
+   run_hTMLE(df = data_mosq_list$long,
+             effecttype = 'spillover',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g,
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Mosquito")
[1] "Fitting htmle model ======================================="
[1] "Covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover       0
pre_incidence         0
pre_rainfall          0
pop_size_ea           0
pre_evi               0
ea_elevation          0
surface_temp          0


Covariates selected (P<0.2):
                      P-value
pre_spray_cover  2.958763e-47
pre_incidence   5.875396e-240
pre_rainfall     2.486381e-38
pop_size_ea     5.535174e-106
pre_evi          3.469551e-27
ea_elevation    2.672746e-285
surface_temp     7.299018e-61
[1] "===== variables excluded after lmtest ===== "
character(0)
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pop_size_ea"    
[5] "pre_evi"         "ea_elevation"    "surface_temp"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.00000
pop_500m                 0.00000
pop_1km                  0.00000
pop_2km                  0.00103
pop_3km                  0.04389
sex                      0.00000
dist_hh                  0.00313
dist_hf                  0.00000
pop_size_cohort          0.68973
Ntx                      0.00000
tx_cov_cohort            0.00010
high_season              0.00014
prop_prev_tx             0.00000
pre_int_3000             0.00000
pre_int_2000             0.00000
pre_int_1000             0.00000
pre_int_500              0.00000
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.00009
pre_int_propdiffarm_1000 0.00000
pre_int_propdiffarm_2000 0.00002
pre_int_propdiffarm_3000 0.00000
age                      0.00012
delta_age                0.00000
response_time            0.00000
delta_response_time      0.67805
delta_age.1              0.00000
delta_response_time.1    0.67805
delta_dist_index_quant   0.80394


Covariates selected (P<0.2):
                               P-value
dist_to_index             3.040619e-09
pop_500m                  3.885163e-07
pop_1km                   2.561023e-08
pop_2km                   1.033403e-03
pop_3km                   4.389029e-02
sex                       1.593784e-12
dist_hh                   3.129748e-03
dist_hf                   6.254395e-08
Ntx                       9.175947e-21
tx_cov_cohort             9.615037e-05
high_season               1.434338e-04
prop_prev_tx              4.949461e-74
pre_int_3000              2.595979e-24
pre_int_2000              1.737552e-31
pre_int_1000              1.004860e-84
pre_int_500               4.241260e-17
n_int_pre_recei           3.698685e-68
pre_int_propdiffarm_500   8.642454e-05
pre_int_propdiffarm_1000  1.584171e-29
pre_int_propdiffarm_2000  1.858308e-05
pre_int_propdiffarm_3000  4.718393e-13
age                       1.154397e-04
delta_age                2.568537e-194
response_time             1.471536e-56
delta_age.1              2.568537e-194
[1] "===== variables excluded after lmtest ===== "
[1] "pop_size_cohort"        "delta_response_time"    "delta_dist_index_quant"
[1] "===== variables excluded after sparsity check ===== "
[1] "pre_int_propdiffarm_500"
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "pop_500m"                
 [3] "pop_1km"                  "pop_2km"                 
 [5] "pop_3km"                  "sex"                     
 [7] "dist_hh"                  "dist_hf"                 
 [9] "Ntx"                      "tx_cov_cohort"           
[11] "high_season"              "prop_prev_tx"            
[13] "pre_int_3000"             "pre_int_2000"            
[15] "pre_int_1000"             "pre_int_500"             
[17] "n_int_pre_recei"          "pre_int_propdiffarm_1000"
[19] "pre_int_propdiffarm_2000" "pre_int_propdiffarm_3000"
[21] "age"                      "delta_age"               
[23] "response_time"           
7.59 sec elapsed
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "Cohort-level covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.02029
pre_incidence   0.02103
pre_rainfall    0.25906
pop_size_ea     0.61201
pre_evi         0.24238
ea_elevation    0.02744
surface_temp    0.88772


Covariates selected (P<0.2):
                   P-value
pre_spray_cover 0.02029447
pre_incidence   0.02102554
ea_elevation    0.02744243
[1] "===== variables excluded after lmtest ===== "
[1] "pre_rainfall" "pop_size_ea"  "pre_evi"      "surface_temp"
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "ea_elevation"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.50494
pop_500m                 0.16321
pop_1km                  0.92402
pop_2km                  0.25937
pop_3km                  0.68784
sex                      1.00000
dist_hh                  0.69512
dist_hf                  0.02386
pop_size_cohort          0.23498
Ntx                      0.00534
tx_cov_cohort            0.87530
high_season              0.33656
prop_prev_tx             0.00000
pre_int_3000             0.00007
pre_int_2000             0.00000
pre_int_1000             0.00000
pre_int_500              0.00056
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.15756
pre_int_propdiffarm_1000 0.00180
pre_int_propdiffarm_2000 0.19583
pre_int_propdiffarm_3000 0.17780
age                      0.00063
delta_age                0.00014
response_time            0.00002
delta_response_time      0.39529
delta_dist_index_quant   0.02958


Covariates selected (P<0.2):
                              P-value
pop_500m                 1.632066e-01
dist_hf                  2.385977e-02
Ntx                      5.339485e-03
prop_prev_tx             1.355907e-06
pre_int_3000             7.481195e-05
pre_int_2000             3.438999e-06
pre_int_1000             9.434530e-08
pre_int_500              5.630021e-04
n_int_pre_recei          1.336365e-08
pre_int_propdiffarm_500  1.575588e-01
pre_int_propdiffarm_1000 1.800269e-03
pre_int_propdiffarm_2000 1.958268e-01
pre_int_propdiffarm_3000 1.778023e-01
age                      6.317962e-04
delta_age                1.351896e-04
response_time            2.095759e-05
delta_dist_index_quant   2.958228e-02
[1] "===== variables excluded after lmtest ===== "
 [1] "dist_to_index"       "pop_1km"             "pop_2km"            
 [4] "pop_3km"             "sex"                 "dist_hh"            
 [7] "pop_size_cohort"     "tx_cov_cohort"       "high_season"        
[10] "delta_response_time"
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
[1] "sex"
[1] "===== variables selected in the end ===== "
 [1] "pop_500m"                 "dist_hf"                 
 [3] "Ntx"                      "prop_prev_tx"            
 [5] "pre_int_3000"             "pre_int_2000"            
 [7] "pre_int_1000"             "pre_int_500"             
 [9] "n_int_pre_recei"          "pre_int_propdiffarm_500" 
[11] "pre_int_propdiffarm_1000" "pre_int_propdiffarm_2000"
[13] "pre_int_propdiffarm_3000" "age"                     
[15] "delta_age"                "response_time"           
[17] "delta_dist_index_quant"  
[1] "<20 obs per covariate for g model; creating small regression learners"
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.013, 0.015"
[1] "updated Qbar1W, Qbar0W: 0.013, 0.015"
10.87 sec elapsed
> toc()
24.632 sec elapsed
> 
> saveRDS(res_spillover_mosq, file = paste0(results_path, "namibia_htmle_inc_spillover_mosq_sens_nooverlap_spill.RDS"))
> 
> ## Human & mosquito---------------------------------------
> tic()
> set.seed(123)
> res_spillover_hm <- 
+   run_hTMLE(df = data_hm_list$long,
+             effecttype = 'spillover',
+             Qlevel = "individual", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g, # setting to mean to avoid unstable estimates
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Human & mosquito",
+             Vfolds = 30)
[1] "Fitting htmle model ======================================="
[1] "Covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.14189
pre_incidence   0.00000
pre_rainfall    0.00000
pop_size_ea     0.00002
pre_evi         0.00000
ea_elevation    0.00000
surface_temp    0.00012


Covariates selected (P<0.2):
                      P-value
pre_spray_cover  1.418863e-01
pre_incidence   1.776795e-229
pre_rainfall     0.000000e+00
pop_size_ea      1.818974e-05
pre_evi          1.391862e-27
ea_elevation    3.373900e-182
surface_temp     1.184483e-04
[1] "===== variables excluded after lmtest ===== "
character(0)
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pop_size_ea"    
[5] "pre_evi"         "ea_elevation"    "surface_temp"   

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.00000
pop_500m                 0.00000
pop_1km                  0.00026
pop_2km                  0.32575
pop_3km                  0.06696
sex                      0.00000
dist_hh                  0.00002
dist_hf                  0.00000
pop_size_cohort          0.93075
Ntx                      0.00262
tx_cov_cohort            0.33056
high_season              0.00001
prop_prev_tx             0.00000
pre_int_3000             0.00000
pre_int_2000             0.00000
pre_int_1000             0.00000
pre_int_500              0.00000
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.02593
pre_int_propdiffarm_1000 0.00000
pre_int_propdiffarm_2000 0.00000
pre_int_propdiffarm_3000 0.00002
age                      0.00000
delta_age                0.00000
response_time            0.00000
delta_response_time      0.77998
delta_age.1              0.00000
delta_response_time.1    0.77998
delta_dist_index_quant   0.27058


Covariates selected (P<0.2):
                              P-value
dist_to_index            6.211508e-09
pop_500m                 4.116529e-07
pop_1km                  2.614701e-04
pop_3km                  6.695595e-02
sex                      6.902613e-07
dist_hh                  2.207733e-05
dist_hf                  8.483766e-18
Ntx                      2.615978e-03
high_season              8.742787e-06
prop_prev_tx             1.411625e-68
pre_int_3000             2.309343e-21
pre_int_2000             1.869331e-41
pre_int_1000             3.962288e-67
pre_int_500              8.710402e-16
n_int_pre_recei          1.542002e-42
pre_int_propdiffarm_500  2.592665e-02
pre_int_propdiffarm_1000 8.129852e-20
pre_int_propdiffarm_2000 4.991989e-08
pre_int_propdiffarm_3000 2.257566e-05
age                      3.012919e-06
delta_age                2.496058e-94
response_time            1.735784e-47
delta_age.1              2.496058e-94
[1] "===== variables excluded after lmtest ===== "
[1] "pop_2km"                "pop_size_cohort"        "tx_cov_cohort"         
[4] "delta_response_time"    "delta_dist_index_quant"
[1] "===== variables excluded after sparsity check ===== "
[1] "pre_int_propdiffarm_500"
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "pop_500m"                
 [3] "pop_1km"                  "pop_3km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "dist_hf"                  "Ntx"                     
 [9] "high_season"              "prop_prev_tx"            
[11] "pre_int_3000"             "pre_int_2000"            
[13] "pre_int_1000"             "pre_int_500"             
[15] "n_int_pre_recei"          "pre_int_propdiffarm_1000"
[17] "pre_int_propdiffarm_2000" "pre_int_propdiffarm_3000"
[19] "age"                      "delta_age"               
[21] "response_time"           
3.757 sec elapsed
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "Cohort-level covariate screening ---------------------------------"

Likelihood Ratio Test P-values:
                P-value
pre_spray_cover 0.07235
pre_incidence   0.00016
pre_rainfall    0.01121
pop_size_ea     0.45865
pre_evi         0.16731
ea_elevation    0.32191
surface_temp    0.88105


Covariates selected (P<0.2):
                     P-value
pre_spray_cover 0.0723475739
pre_incidence   0.0001640757
pre_rainfall    0.0112088086
pre_evi         0.1673106511
[1] "===== variables excluded after lmtest ===== "
[1] "pop_size_ea"  "ea_elevation" "surface_temp"
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
character(0)
[1] "===== variables selected in the end ===== "
[1] "pre_spray_cover" "pre_incidence"   "pre_rainfall"    "pre_evi"        

Likelihood Ratio Test P-values:
                         P-value
dist_to_index            0.13570
pop_500m                 0.36296
pop_1km                  0.86035
pop_2km                  0.63877
pop_3km                  0.71459
sex                      1.00000
dist_hh                  0.32121
dist_hf                  0.00929
pop_size_cohort          0.56153
Ntx                      0.35995
tx_cov_cohort            0.91604
high_season              0.16580
prop_prev_tx             0.00001
pre_int_3000             0.00441
pre_int_2000             0.00005
pre_int_1000             0.00001
pre_int_500              0.00102
n_int_pre_recei          0.00000
pre_int_propdiffarm_500  0.39335
pre_int_propdiffarm_1000 0.03721
pre_int_propdiffarm_2000 0.25970
pre_int_propdiffarm_3000 0.80539
age                      0.02479
delta_age                0.00715
response_time            0.00033
delta_response_time      0.38798
delta_dist_index_quant   0.04564


Covariates selected (P<0.2):
                              P-value
dist_to_index            1.357004e-01
dist_hf                  9.288991e-03
high_season              1.657955e-01
prop_prev_tx             8.765210e-06
pre_int_3000             4.406861e-03
pre_int_2000             4.908358e-05
pre_int_1000             8.627577e-06
pre_int_500              1.016221e-03
n_int_pre_recei          6.357480e-07
pre_int_propdiffarm_1000 3.721173e-02
age                      2.478502e-02
delta_age                7.146404e-03
response_time            3.318321e-04
delta_dist_index_quant   4.564278e-02
[1] "===== variables excluded after lmtest ===== "
 [1] "pop_500m"                 "pop_1km"                 
 [3] "pop_2km"                  "pop_3km"                 
 [5] "sex"                      "dist_hh"                 
 [7] "pop_size_cohort"          "Ntx"                     
 [9] "tx_cov_cohort"            "pre_int_propdiffarm_500" 
[11] "pre_int_propdiffarm_2000" "pre_int_propdiffarm_3000"
[13] "delta_response_time"     
[1] "===== variables excluded after sparsity check ===== "
character(0)
[1] "===== excluded constant variables ===== "
[1] "sex"
[1] "===== variables selected in the end ===== "
 [1] "dist_to_index"            "dist_hf"                 
 [3] "high_season"              "prop_prev_tx"            
 [5] "pre_int_3000"             "pre_int_2000"            
 [7] "pre_int_1000"             "pre_int_500"             
 [9] "n_int_pre_recei"          "pre_int_propdiffarm_1000"
[11] "age"                      "delta_age"               
[13] "response_time"            "delta_dist_index_quant"  
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.015, 0.016"
[1] "updated Qbar1W, Qbar0W: 0.014, 0.017"
585.017 sec elapsed
> toc()
591.737 sec elapsed
> 
> saveRDS(res_spillover_hm, file = paste0(results_path, "namibia_htmle_inc_spillover_hm_sens_nooverlap_spill.RDS"))
> 
> 
> # Run hTMLE - Direct effect ---------------------------------------
> 
> ## Human ---------------------------------------
> tic()
> set.seed(123)
> res_direct_human <- 
+   run_hTMLE(df = data_human_list$short,
+             effecttype = 'direct',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g,
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Human")
[1] "Fitting htmle model ======================================="
[1] "Too few observations to fit model"
> toc()
1.37 sec elapsed
> 
> saveRDS(res_direct_human, file = paste0(results_path, "namibia_htmle_inc_direct_human_sens_nooverlap_spill.RDS"))
> 
> 
> ## Mosquito ---------------------------------------
> tic()
> set.seed(123)
> res_direct_mosq <-  run_hTMLE(df = data_mosq_list$long,
+             effecttype = 'direct',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g,
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Mosquito")
[1] "Fitting htmle model ======================================="
[1] "Too few observations to fit adjusted model"
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.008, 0.004"
[1] "updated Qbar1W, Qbar0W: 0.006, 0.005"
2.092 sec elapsed
> toc()
6.287 sec elapsed
> 
> saveRDS(res_direct_mosq, file = paste0(results_path, "namibia_htmle_inc_direct_mosq_sens_nooverlap_spill.RDS"))
> 
> 
> ## Human & mosquito ---------------------------------------
> tic()
> set.seed(123)
> res_direct_hm <- 
+   run_hTMLE(df = data_hm_list$long,
+             effecttype = 'direct',
+             Qlevel = "cohort", # cohort/individual/adaptive for incidence, individual for prev
+             glevel = "cohort", # always cohort for incidence, individual for prev
+             dependency = TRUE, # TRUE if we want CIs adjusted for dependency
+             unadj_est = FALSE, # TRUE if we want a unadjusted estimate
+             y_l = 0,
+             y_u = 1,
+             covarname_g = covarname_g,    # set of names for adjustment variables
+             covarname_Q = covarname_Q,
+             SL_lib_Q = SL_lib_Q,
+             SL_lib_g = SL_lib_g, # setting to mean to avoid unstable estimates
+             SL_lib_adaQ = SL_lib_simple, # need to specify if for Qlevel = "cohort"
+             SL_lib_depen = SL_lib_simple, # need to specify if dependency = T
+             verbose = FALSE,
+             reservoir_name = "Human & mosquito",
+             Vfolds = 30)
[1] "Fitting htmle model ======================================="
[1] "Too few observations to fit adjusted model"
[1] "Choose Qlevel ---------------------------------"
0 sec elapsed
[1] "hTMLE estimation ---------------------------------"
[1] "initial Qbar1W, Qbar0W: 0.009, 0.003"
[1] "updated Qbar1W, Qbar0W: 0.006, 0.005"
3.479 sec elapsed
> toc()
5.41 sec elapsed
> 
> saveRDS(res_direct_hm, file = paste0(results_path, "namibia_htmle_inc_direct_hm_sens_nooverlap_spill.RDS"))
> 
> proc.time()
    user   system  elapsed 
1580.086 1842.614  979.492 
